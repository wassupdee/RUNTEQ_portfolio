<div class="flex flex-col items-center mb-20 md:mb-10">
  <div class="md:border md:rounded-3xl md:border-slate-100 md:p-10 md:mt-10 md:mt-10 md:bg-opacity-10 md:shadow-2xl">
    <div data-controller="previews" class="flex flex-col">
      <%= form_with(model: [profile, album], data: { turbo: false }) do |form| %>
        <%= render 'shared/error_messages', model: form.object %>

        <div class="mb-4">
          <%= form.label :date, "日付", class: "block font-medium mb-1 text-black" %>
          <%= form.date_field :date, class: "block font-medium mb-5 bg-button-gray text-white border border-gray-400 rounded" %>
        </div>

        <div class="mb-4">
          <%= form.label :title, "タイトル", class: "block font-medium mb-1 text-black" %>
          <%= form.text_field :title, class: "w-full rounded p-2 bg-white border border-gray-400" %>
        </div>

        <div class="mb-4">
          <%= form.label :diary, "ノート", class: "block font-medium mb-1 text-black" %>
          <%= form.text_area :diary, class: "w-full rounded p-2 bg-white border border-gray-400" %>
        </div>

        <div class="mb-4">
          <%= form.label :image, "写真", class: "block font-medium mb-1 text-black" %>
          <turbo-frame id="album_hidden_fields">
            <% album.images.each do |image| %>
              <% if image.persisted? %>
                <%= form.hidden_field :images, multiple: true, value: image.signed_id %>
              <% end %>
            <% end %>
          </turbo-frame>
          <%= form.file_field :images, multiple: true, data: { previews_target: "input", action: "change->previews#preview" } %>
        </div>

        <div class="flex justify-center">
          <%= form.submit "保存する", class: "btn bg-golden text-black border-none hover:bg-yellow-500" %>
        </div>
      <% end %>

      <% if album.images.attached? && album.persisted? %>
        <% album.images.each do |image| %>
          <div id="<%= "#{dom_id(album)}-#{image.id}" %>">
          <% if image.persisted? %>
            <%= image_tag image.variant(resize_to_limit: [100, 100]) %>
            <%= link_to "削除", image_path(image), data: { turbo_confirm: "本当に削除しますか？", turbo_method: :delete } %>
          <% end %>
          </div>
        <% end %>
      <% end %>
      <div data-previews-target="previewContainer"></div>
    </div>
  </div>
</div>
